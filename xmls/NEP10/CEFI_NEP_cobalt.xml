<?xml version="1.0"?>
<!-- FRE Usage documentation: http://www.gfdl.noaa.gov/fms/fre -->
<!--
Quick start guide

On GFDL Analysis:
module load fre/bronx-22

On Gaea:
module use /ncrc/home2/fms/local/modulefiles
module load fre/bronx-22

C5:
fremake -x CEFI_NEP_cobalt.xml -p ncrc5.intel23 -t repro MOM6_SIS2_GENERIC_4P_compile_symm
frerun  -x CEFI_NEP_cobalt.xml -p ncrc5.intel23 -t repro CEFI_NEP_COBALT_V1

Regression test
frerun -x CEFI_NEP_cobalt.xml -p ncrc5.intel23 -q debug -r test -t repro CEFI_NEP_COBALT_V1

C6:
fremake -x CEFI_NEP_cobalt.xml -p ncrc6.intel23 -t repro MOM6_SIS2_GENERIC_4P_compile_symm
frerun  -x CEFI_NEP_cobalt.xml -p ncrc6.intel23 -t repro CEFI_NEP_COBALT_V1

pp (on PPAN):
frepp -t 2019 -c ocean_cobalt_tracers_month_z -d /archive/e1n/fre/cefi/NEP/2024_08/NEP10k_082024_clean_spinup/gfdl.ncrc5-intel22-repro/history/ -x CEFI_NEP_cobalt.xml -p gfdl.ncrc6-intel23 -T repro CEFI_NEP_COBALT_V1

Regression test
frerun -x CEFI_NEP_cobalt.xml -p ncrc6.intel23 -q debug -r test -t repro CEFI_NEP_COBALT_V1

To check if the restart files are identical from regression test:
frecheck -v -r restart -p ncrc6.intel23 -t repro  -x CEFI_NEP_cobalt.xml CEFI_NEP_COBALT_V1

-->



<experimentSuite rtsVersion="4" xmlns:xi="http://www.w3.org/2001/XInclude">
  <!-- git tag for general component source code-->
  <property name="RELEASE" value="2024.02"/>

  <!-- git tag for FMS source code -->
  <property name="FMS_GIT_TAG" value="2025.01"/>

  <!-- git tag for coupler source code -->
  <property name="CPL_GIT_TAG" value="2025.01"/>

  <!-- git tag for null (atmos_null, land_null, etc) source code -->
  <property name="NULL_TAG" value="2023.04"/>

  <!-- git tag for ocean_shared source code -->
  <property name="OCEAN_BGC_GIT_TAG" value="dev/cefi"/>

  <!-- Updated MOM6 source code commit to checkout -->
  <property name="MOM6_GIT_TAG" value="main"/>

  <!-- Updated Icepack commit to check out -->
  <property name="ICEPACK_GIT_TAG" value="Icepack1.3.3"/>

  <!-- customize as needed -->
  <property name="FRE_STEM" value="fre/cefi/NEP/2025_02"/>

  <!-- Please make sure to change your group, such as b, f, g, m, o... -->
  <!-- NCRC_GROUP will only have impact for your root dir and work dir on gaea c5/c6-->
  <!-- You have to either use -A or go to xml_include/xml_building_blocks/platforms.xml to change project for your project allocation-->
  <property name="NCRC_GROUP" value="ira-cefi"/>
  <property name="NCRC_GROUP_C5" value="cefi"/>
  <property name="GFDL_GROUP" value="cefi"/>

  <!--Production run properties. Users can modify these according to their need and/or performance analysis-->
  <property name="PROD_SIMTIME" value="27"/>

  <!--Post-processing  chunk lengths -->
  <property name="CHUNK_LENGTH_A" value="5yr"/>
  <property name="CHUNK_LENGTH_B" value="27yr"/>

  <!--Start year of post processing -->
  <property name="PP_START_YEAR" value="1993"/>

  <!-- fre version to be used -->
  <property name="FRE_VERSION" value="bronx-22"/>

  <!-- on/off switch for MDBI database -->
  <property name="MDBIswitch" value="off"/>

  <!--Users need not change the following properties -->
  <!-- Reference release tag for existing files in the archives for answer comparison. Used in "REFERENCE" property. -->
  <property name="reference_tag" value="none"/>

  <!-- The following properties are for testing/debugging purposes and should normally be empty-->
  <property name="MODIFIER" value=""/>
  <property name="DEBUGLEVEL" value=""/>
  <property name="BUILD_DATE" value=""/>

  <!-- name for source/exec directory -->
  <property name="STATIC" value=""/>

  <!--This is necessary only if you want to run exact same experiment on multiple platforms-->
  <property name="PLATINFO" value=""/>
  <property name="AWG_INPUT_HOME_GAEA" value="../xml_include"/>
  <property name="AWG_INPUT_HOME_GFDL" value="/work/Liz.Drenkard/mom6/xml_include"/>
  <!--The start year of forcing dataset-->
  <!-- fre sets baseDate from input_nml, so this sets fyear from basedate. -->
  <!-- This needs to be set early so the appropriate files for the year can be copied. -->
  <property name="append_to_setup_csh" value="set fyear=`echo $baseDate | cut -c1-4`"/>

  <!-- Using a custom version of platforms: https://gitlab.gfdl.noaa.gov/andrew.c.ross/xml_include -->
  <setup>
    <xi:include href="../xml_include/xml_building_blocks/platforms.xml" xpointer="xpointer(//freInclude/platform[@name='ncrc5.intel23'])"/>
    <xi:include href="../xml_include/xml_building_blocks/platforms.xml" xpointer="xpointer(//freInclude/platform[@name='gfdl.ncrc5-intel23'])"/>
    <xi:include href="../xml_include/xml_building_blocks/platforms.xml" xpointer="xpointer(//freInclude/platform[@name='ncrc6.intel23'])"/>
    <xi:include href="../xml_include/xml_building_blocks/platforms.xml" xpointer="xpointer(//freInclude/platform[@name='gfdl.ncrc6-intel23'])"/>
  </setup>

  <!--= COMPILE =-->
  <!--===========-->
  <!--The property MOM6_EXAMPLES should point to the mom6 directory that is checked out. It is needed by MOM6 to access its input data files-->
  <property name="PROG_MAIN" value="coupler/coupler_main.o"/>
  <property name="LIBS_ROOT" value="MOM6_SIS2_GENERIC_4P_compile_symm"/>
  <property name="FMS_LIB_DIR" value="./$(LIBS_ROOT)/$(platform)-$(target)/exec"/>

  <property name="MY_LIBS" value="$(EXEC_ROOT)/$(FMS_LIB_DIR)"/>

  <experiment name="MOM6_SIS2_GENERIC_4P_compile_symm">
    <description>
      Make the executable for ocean-ice experiments.
    </description>
    <component name="fms" paths="FMS">
      <source versionControl="git" root="https://github.com/NOAA-GFDL">
        <codeBase version="$(FMS_GIT_TAG)"> FMS.git </codeBase>
      </source>
      <compile>
        <cppDefs>-Duse_libMPI -Duse_netCDF $(F2003_FLAGS) -DMAXFIELDMETHODS_=600</cppDefs>
      </compile>
    </component>

    <component name="mom6_symmetric" requires="fms" paths="mom6/src/MOM6/config_src/memory/dynamic_symmetric mom6/src/MOM6/config_src/drivers/FMS_cap mom6/src/MOM6/src/*/ mom6/src/MOM6/src/*/*/ mom6/src/MOM6/config_src/external/ODA_hooks mom6/src/MOM6/config_src/external/stochastic_physics mom6/src/MOM6/config_src/external/drifters mom6/src/MOM6/config_src/external/database_comms mom6/src/ocean_BGC/generic_tracers mom6/src/ocean_BGC/mocsy/src mom6/src/MOM6/pkg/GSW-Fortran/modules mom6/src/MOM6/pkg/GSW-Fortran/toolbox mom6/src/MOM6/config_src/infra/FMS2">
      <source versionControl="git" root="https://github.com/NOAA-GFDL">
              <codeBase version="$(MOM6_GIT_TAG)">CEFI-regional-MOM6.git </codeBase>
        <csh><![CDATA[
          mv CEFI-regional-MOM6 mom6
        ]]></csh>
      </source>
      <compile>
        <cppDefs><![CDATA[ $(F2003_FLAGS) -DMAX_FIELDS_=100 -DUSE_FMS2_IO -DNOT_SET_AFFINITY -D_USE_MOM6_DIAG -D_USE_GENERIC_TRACER  -DUSE_PRECISION=2 -D_FILE_VERSION="'"`git-version-string $<`"'" ]]></cppDefs>
        <!--makeOverrides>OPENMP=""</makeOverrides>  openmp switch for MOM6 may cause crash -->
      </compile>
    </component>

    <component name="Icepack" paths="mom6/src/Icepack/columnphysics" requires="fms mom6_symmetric" includeDir="$root/$(LIBS_ROOT)/src/mom6/src/MOM6/src/framework" >
      <source versionControl="git" root="https://github.com/CICE-Consortium/">
        <codeBase version="$(ICEPACK_GIT_TAG)"> Icepack.git </codeBase>
      </source>
      <compile>
         <cppDefs><![CDATA[]]></cppDefs>
      </compile>
    </component>

    <component name="sis2" paths="mom6/src/SIS2/config_src/dynamic_symmetric mom6/src/SIS2/src mom6/src/icebergs/src mom6/src/ice_param" requires="fms mom6_symmetric Icepack" includeDir="$root/$(LIBS_ROOT)/src/mom6/src/MOM6/src/framework" >
      <source versionControl="git" root="https://github.com/NOAA-GFDL">
        <codeBase version="$(RELEASE)"> ice_param.git </codeBase>
      </source>
      <compile>
         <cppDefs><![CDATA[$(F2003_FLAGS) -DUSE_FMS2_IO -D_FILE_VERSION="'"`git-version-string $<`"'"]]></cppDefs>
      </compile>
    </component>

    <component name="land_null" paths="mom6/src/land_null" requires="fms">
      <description domainName="NA" communityName="NA" communityVersion="NA" communityGrid="NA"/>
      <source versionControl="git" root="https://github.com/NOAA-GFDL">
        <codeBase version="$(NULL_TAG)"> land_null.git </codeBase>
      </source>
    </component>

    <component name="atmos_null" paths="mom6/src/atmos_null" requires="fms">
      <source versionControl="git" root="https://github.com/NOAA-GFDL">
        <codeBase version="$(CPL_GIT_TAG)"> atmos_null.git </codeBase>
      </source>
      <compile>
        <cppDefs>$(F2003_FLAGS) </cppDefs>
      </compile>
    </component>

    <component name="coupler" paths="mom6/src/coupler/full mom6/src/coupler/shared" requires="fms land_null atmos_null sis2 mom6_symmetric">
      <description domainName="FMS Coupler" communityName="coupler" communityVersion="$(CPL_GIT_TAG)" communityGrid=""/>
      <source versionControl="git" root="https://github.com/NOAA-GFDL">
        <codeBase version="$(CPL_GIT_TAG)"> coupler.git </codeBase>
      </source>
      <compile>
        <cppDefs><![CDATA[$(F2003_FLAGS) -DUSE_FMS2_IO -D_USE_LEGACY_LAND_ -Duse_AM3_physics -D_FILE_VERSION="'"`git-version-string $<`"'"]]></cppDefs>
      </compile>
    </component>
  </experiment>

  <experiment name="CEFI_NEP_COBALT_V1" inherit="MOM6_SIS2_GENERIC_4P_compile_symm">
    <description>
      Base MOM6-NEP BGC hindcast.
      Based on NEP_cefi_bgc_burial config
    </description>
    <input>
      <namelist name="coupler_nml">
        months = $months
        days   = $days
        current_date = 1993,1,1,0,0,0
        hours = 0
        minutes = 0
        seconds = 0
        calendar = 'gregorian'
        dt_cpld  = 3600
        dt_atmos = 3600
        do_atmos = .false.
        do_land = .false.
        do_ice = .true.
        do_ocean = .true.
        atmos_npes = 0,
        ocean_npes = 0,
        concurrent = .false.
        use_lag_fluxes=.false.
        atmos_nthreads = $atm_threads
        ocean_nthreads = $ocn_threads
        do_chksum = .false.
        do_endpoint_chksum = .false.
      </namelist>
      <namelist name ="cobalt_input_nml">
        parameter_filename = 'INPUT/COBALT_input','INPUT/COBALT_override'
      </namelist>
      <namelist name="generic_tracer_nml">
        do_generic_tracer=.true.
        do_generic_abiotic=.false.
        do_generic_CFC=.false.
        do_generic_COBALT=.true.
        do_generic_age=.false.
        do_generic_SF6=.false.
        force_update_fluxes=.true.
        as_param='W14'
        do_vertfill_post=.true.
      </namelist>
      <namelist name="time_interp_external_nml">
        max_fields = 400
      </namelist>
      <namelist name="generic_abiotic_nml">
       co2_calc='mocsy'
      </namelist>
      <namelist name="generic_COBALT_nml">
       co2_calc = 'mocsy'
       imbalance_tolerance=1.0e-9
      </namelist>
      <namelist name="diag_manager_nml">
        max_files = 600
        flush_nc_files=.false.
        max_axes = 600
        max_num_axis_sets = 600
        max_input_fields = 2000
        max_output_fields = 5000
        mix_snapshot_average_fields=.false.
      </namelist>
      <namelist name="xgrid_nml">
        make_exchange_reproduce = .false.
        interp_method = 'second_order'
      </namelist>
      <namelist name="fms_nml">
        clock_grain='ROUTINE'
        clock_flags='NONE'
        domains_stack_size = 8000000
        stack_size =0
      </namelist>
      <namelist name="fms2_io_nml">
        fms_netcdf_restart=.true.
        threading_read='multi'
        max_files_r = 800
        max_files_w = 800
        checksum_required=.false.
      </namelist>
      <namelist name="atmos_model_nml">
        layout= 1,1
      </namelist>
      <!--verona-->
      <namelist name="sat_vapor_pres_nml">
        construct_table_wrt_liq = .true.
        construct_table_wrt_liq_and_ice = .true.
      </namelist>
      <namelist name="ice_albedo_nml">
        t_range = 10.
      </namelist>
      <namelist name="icebergs_nml">
        verbose=.false.
        verbose_hrs=24
        traj_sample_hrs=24
        debug=.false.
        really_debug=.false.
        use_slow_find=.true.
        add_weight_to_ocean=.true.
        passive_mode=.false.
        generate_test_icebergs=.false.
        speed_limit=0.
        use_roundoff_fix=.true.
        make_calving_reproduce=.true.
      </namelist>
      <namelist name="monin_obukhov_nml">
        neutral = .true.
      </namelist>
      <namelist name="ocean_albedo_nml">
        ocean_albedo_option = 2
      </namelist>
      <namelist name="ocean_rough_nml">
        rough_scheme = 'beljaars'
      </namelist>
      <namelist name="surface_flux_nml">
        ncar_ocean_flux_multilevel = .true.
        bulk_zu = 10.0
        bulk_zt = 2.0
        bulk_zq = 2.0
        raoult_sat_vap = .true.
      </namelist>

      <!--common setup-->
      <xi:include xpointer="xpointer(//freInclude[@name='choose_restart']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='OM4_common']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='nep_grid']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='nep_data']/input/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='SIS2_data']/input/node())"/>

      <dataTable>
"ATM", "p_surf",             "msl",    "INPUT/ERA5_msl_${fyear}_padded.nc",    "bilinear",  1.0
"ATM", "p_bot",              "msl",    "INPUT/ERA5_msl_${fyear}_padded.nc",    "bilinear",  1.0
"ATM", "t_bot",              "t2m",    "INPUT/ERA5_t2m_${fyear}_padded.nc",    "bilinear",  1.0
"ATM", "sphum_bot",          "sphum",  "INPUT/ERA5_sphum_${fyear}_padded.nc",  "bilinear",  1.0
"ATM", "u_bot",              "u10",    "INPUT/ERA5_u10_${fyear}_padded.nc",    "bicubic",   1.0
"ATM", "v_bot",              "v10",    "INPUT/ERA5_v10_${fyear}_padded.nc",    "bicubic",   1.0
"ATM", "z_bot",              "",       "",                            "bilinear",  10.0
"ATM", "gust",               "",       "",                            "bilinear",  1.0e-4
"ATM", "o2_flux_pcair_atm",  "",       "",                            "none",      0.214
"ATM", "co2_flux_pcair_atm", "mole_fraction_of_carbon_dioxide_in_air", "INPUT/mole_fraction_of_co2_extended_ssp245.nc", "bilinear", 1.0e-06
"ATM", "co2_bot",            "mole_fraction_of_carbon_dioxide_in_air", "INPUT/mole_fraction_of_co2_extended_ssp245.nc", "bilinear", 1.0e-06
"ATM", "co2_dvmr_restore",   "mole_fraction_of_carbon_dioxide_in_air", "INPUT/mole_fraction_of_co2_extended_ssp245.nc", "bilinear", 1.0e-06
# Scaling factors in the last column include both
# units conversion (radiation: J m-2 -> W m-2, precipitation: m -> kg m-2 s-1 == mm s-1)
# and division of shortwave radiation (57% visible, 43% near IR, both half direct and half diffuse).
"ICE", "lw_flux_dn"        , "strd",   "INPUT/ERA5_strd_${fyear}_padded.nc",   "bilinear",  2.77778e-4
"ICE", "sw_flux_vis_dir_dn", "ssrd",   "INPUT/ERA5_ssrd_${fyear}_padded.nc",   "bilinear",  7.9167e-5
"ICE", "sw_flux_vis_dif_dn", "ssrd",   "INPUT/ERA5_ssrd_${fyear}_padded.nc",   "bilinear",  7.9167e-5
"ICE", "sw_flux_nir_dir_dn", "ssrd",   "INPUT/ERA5_ssrd_${fyear}_padded.nc",   "bilinear",  5.9722e-5
"ICE", "sw_flux_nir_dif_dn", "ssrd",   "INPUT/ERA5_ssrd_${fyear}_padded.nc",   "bilinear",  5.9722e-5
"ICE", "lprec",              "lp",     "INPUT/ERA5_lp_${fyear}_padded.nc",     "bilinear",  0.277777778
"ICE", "fprec",              "sf",     "INPUT/ERA5_sf_${fyear}_padded.nc",     "bilinear",  0.277777778
"ICE", "runoff",             "runoff", "INPUT/glofas_v4_hill_dis_runoff_${fyear}.nc",      "none",      1.0
"ICE", "calving",            "",       "",                           "none",      0.0
"ICE", "dhdt",               "",       "",                           "none",     80.0
"ICE", "dedt",               "",       "",                           "none",      2.0e-6
"ICE", "drdt",               "",       "",                           "none",     10.0
#
"LND", "t_surf",             "",       "",                           "none",    273.0
"LND", "t_ca",               "",       "",                           "none",    273.0
"LND", "q_ca",               "",       "",                           "none",     0.0
"LND", "rough_mom",          "",       "",                           "none",     0.01
"LND", "rough_heat",         "",       "",                           "none",     0.1
"LND", "albedo",             "",       "",                           "none",     0.1
"LND", "sphum_surf",         "",       "",                           "none",     0.0
"LND", "sphum_ca",           "",       "",                           "none",     0.0
"LND", "t_flux",             "",       "",                           "none",     0.0
"LND", "sphum_flux",         "",       "",                           "none",     0.0
"LND", "lw_flux",            "",       "",                           "none",     0.0
"LND", "sw_flux",            "",       "",                           "none",     0.0
"LND", "lprec",              "",       "",                           "none",     0.0
"LND", "fprec",              "",       "",                           "none",     0.0
"LND", "dhdt",               "",       "",                           "none",     5.0
"LND", "dedt",               "",       "",                           "none",     2.0e-6
"LND", "dedq",               "",       "",                           "none",     0.0
"LND", "drdt",               "",       "",                           "none",     5.0
"LND", "drag_q",             "",       "",                           "none",     0.0
"LND", "p_surf",             "",       "",                           "none",     1.0e5

"OCN", "runoff_ldon_flux_ice_ocn",  "LDON_CONC",  "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_sldon_flux_ice_ocn", "SLDON_CONC", "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_srdon_flux_ice_ocn", "SRDON_CONC", "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_pdet_flux_ice_ocn",  "PDET_CONC",  "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_ndet_flux_ice_ocn",  "NDET_CONC",  "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_ldop_flux_ice_ocn",  "LDOP_CONC",  "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_sldop_flux_ice_ocn", "SLDOP_CONC", "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_srdop_flux_ice_ocn", "SRDOP_CONC", "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_no3_flux_ice_ocn",   "NO3_CONC",   "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_po4_flux_ice_ocn",   "PO4_CONC",   "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_fed_flux_ice_ocn",   "FED_CONC",   "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_alk_flux_ice_ocn",   "ALK_CONC",   "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_dic_flux_ice_ocn",   "DIC_CONC",   "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_nh4_flux_ice_ocn",   "NH4_CONC",   "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_fedet_flux_ice_ocn", "FEDET_CONC", "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc",  "none",      1.0e-3
"OCN", "runoff_o2_flux_ice_ocn",    "O2_CONC",     "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc", "none",      1.0e-3
"OCN", "runoff_sio4_flux_ice_ocn",  "SI_CONC",     "./INPUT/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc", "none",      1.0e-3
"OCN", "runoff_lith_flux_ice_ocn",  "",           "",                                                             "none",     13.0e-3
#
"OCN", "dry_dep_fed_flux_ice_ocn",  "dryfe",         "./INPUT/esm4_dryfe_climo_1993-2014.nc",                       "bilinear", -1.0
"OCN", "wet_dep_fed_flux_ice_ocn",  "wetfe",         "./INPUT/esm4_wetfe_climo_1993-2014.nc",                       "bilinear", -1.0
"OCN", "dry_dep_lith_flux_ice_ocn", "drydust",       "./INPUT/esm4_drydust_climo_1993-2014.nc",                     "bilinear", -1.0
"OCN", "wet_dep_lith_flux_ice_ocn", "wetdust",       "./INPUT/esm4_wetdust_climo_1993-2014.nc",                     "bilinear", -1.0
"OCN", "dry_dep_po4_flux_ice_ocn",  "drydust",       "./INPUT/esm4_drydust_climo_1993-2014.nc",                     "bilinear",  -4.0e-6
"OCN", "wet_dep_no3_flux_ice_ocn",  "drynoy",        "./INPUT/esm4_drynoy_climo_1993-2014.nc",                      "bilinear", -1.0
"OCN", "dry_dep_no3_flux_ice_ocn",  "wetnoy",         "./INPUT/esm4_wetnoy_climo_1993-2014.nc",                      "bilinear", -1.0
"OCN", "wet_dep_nh4_flux_ice_ocn",  "drynh4",        "./INPUT/esm4_drynh4_climo_1993-2014.nc",                      "bilinear", -1.0
"OCN", "dry_dep_nh4_flux_ice_ocn",  "wetnh4",        "./INPUT/esm4_wetnh4_climo_1993-2014.nc",                      "bilinear", -1.0
     </dataTable>

      <fieldTable>
# specific humidity for moist runs
"TRACER", "atmos_mod", "sphum"
          "longname",     "specific humidity"
          "units",        "kg/kg" /
# prognostic cloud scheme tracers
"TRACER", "atmos_mod", "liq_wat"
          "longname",     "cloud liquid specific humidity"
          "units",        "kg/kg" /
"TRACER", "atmos_mod", "ice_wat"
          "longname",     "cloud ice water specific humidity"
          "units",        "kg/kg" /
"TRACER", "atmos_mod", "cld_amt"
          "longname",     "cloud fraction"
          "units",        "none" /
# sphum must be present on land as well
"TRACER", "land_mod",     "sphum"
          "longname",     "specific humidity"
          "units",        "kg/kg" /

"namelists","ocean_mod","generic_COBALT"
  enforce_src_info = f
  alk_obc_src_file_name = bgc_esper.nc
  alk_obc_lfac_in = 0.03
  alk_obc_lfac_out = 1.0
  cadet_arag_obc_src_file_name = bgc_cobalt.nc
  cadet_arag_obc_lfac_in = 0.03
  cadet_ararg_obc_lfac_out = 1.0
  cadet_calc_obc_src_file_name = bgc_cobalt.nc
  cadet_calc_obc_lfac_in = 0.03
  cadet_calc_obc_lfac_out = 1.0
  dic_obc_src_file_name = bgc_esper.nc
  dic_obc_lfac_in = 0.03
  dic_obc_lfac_out = 1.0
  dic14_obc_src_file_name = bgc_zero.nc
  dic14_obc_lfac_in = 0.03
  dic14_obc_lfac_out = 1.0
  do14_obc_src_file_name = bgc_zero.nc
  do14_obc_lfac_in = 0.03
  do14_obc_lfac_out = 1.0
  do14c_obc_src_file_name = bgc_zero.nc
  do14c_obc_lfac_in = 0.03
  do14c_obc_lfac_out = 1.0
  di14c_obc_src_file_name = bgc_zero.nc
  di14c_obc_lfac_in = 0.03
  di14c_obc_lfac_out = 1.0
  fed_obc_src_file_name = bgc_cobalt.nc
  fed_obc_lfac_in = 0.03
  fed_obc_lfac_out = 1.0
  fedi_obc_src_file_name = bgc_cobalt.nc
  fedi_obc_lfac_in = 0.03
  fedi_obc_lfac_out = 1.0
  felg_obc_src_file_name = bgc_cobalt.nc
  felg_obc_lfac_in = 0.03
  felg_obc_lfac_out = 1.0
  fedet_obc_src_file_name = bgc_cobalt.nc
  fedet_obc_lfac_in = 0.03
  fedet_obc_lfac_out = 1.0
  fesm_obc_src_file_name = bgc_cobalt.nc
  fesm_obc_lfac_in = 0.03
  fesm_obc_lfac_out = 1.0
  ldon_obc_src_file_name = bgc_cobalt.nc
  ldon_obc_lfac_in = 0.03
  ldon_obc_lfac_out = 1.0
  ldop_obc_src_file_name = bgc_cobalt.nc
  ldop_obc_lfac_in = 0.03
  ldop_obc_lfac_out = 1.0
  lith_obc_src_file_name = bgc_cobalt.nc
  lith_obc_lfac_in = 0.03
  lith_obc_lfac_out = 1.0
  lithdet_obc_src_file_name = bgc_cobalt.nc
  lithdet_obc_lfac_in = 0.03
  lithdet_obc_lfac_out = 1.0
  nbact_obc_src_file_name = bgc_cobalt.nc
  nbact_obc_lfac_in = 0.03
  nbact_obc_lfac_out = 1.0
  ndet_obc_src_file_name = bgc_cobalt.nc
  ndet_obc_lfac_in = 0.03
  ndet_obc_lfac_out = 1.0
  ndi_obc_src_file_name = bgc_cobalt.nc
  ndi_obc_lfac_in = 0.03
  ndi_obc_lfac_out = 1.0
  nlg_obc_src_file_name = bgc_cobalt.nc
  nlg_obc_lfac_in = 0.03
  nlg_obc_lfac_out = 1.0
  nsm_obc_src_file_name = bgc_cobalt.nc
  nsm_obc_lfac_in = 0.03
  nsm_obc_lfac_out = 1.0
  nh3_obc_src_file_name = bgc_zero.nc
  nh3_obc_lfac_in = 0.03
  nh3_obc_lfac_out = 1.0
  nh4_obc_src_file_name = bgc_cobalt.nc
  nh4_obc_lfac_in = 0.03
  nh4_obc_lfac_out = 1.0
  no3_obc_src_file_name = bgc_woa.nc
  no3_obc_lfac_in = 0.03
  no3_obc_lfac_out = 1.0
  o2_obc_src_file_name = bgc_woa.nc
  o2_obc_lfac_in = 0.03
  o2_obc_lfac_out = 1.0
  pdet_obc_src_file_name = bgc_cobalt.nc
  pdet_obc_lfac_in = 0.03
  pdet_obc_lfac_out = 1.0
  po4_obc_src_file_name = bgc_woa.nc
  po4_obc_lfac_in = 0.03
  po4_obc_lfac_out = 1.0
  srdon_obc_src_file_name = bgc_cobalt.nc
  srdon_obc_lfac_in = 0.03
  srdon_obc_lfac_out = 1.0
  srdop_obc_src_file_name = bgc_cobalt.nc
  srdop_obc_lfac_in = 0.03
  srdop_obc_lfac_out = 1.0
  sldon_obc_src_file_name = bgc_cobalt.nc
  sldon_obc_lfac_in = 0.03
  sldon_obc_lfac_out = 1.0
  sldop_obc_src_file_name = bgc_cobalt.nc
  sldop_obc_lfac_in = 0.03
  sldop_obc_lfac_out = 1.0
  sidet_obc_src_file_name = bgc_cobalt.nc
  sidet_obc_lfac_in = 0.03
  sidet_obc_lfac_out = 1.0
  silg_obc_src_file_name = bgc_cobalt.nc
  silg_obc_lfac_in = 0.03
  silg_obc_lfac_out = 1.0
  sio4_obc_src_file_name = bgc_woa.nc
  sio4_obc_lfac_in = 0.03
  sio4_obc_lfac_out = 1.0
  nsmz_obc_src_file_name = bgc_cobalt.nc
  nsmz_obc_lfac_in = 0.03
  nsmz_obc_lfac_out = 1.0
  nmdz_obc_src_file_name = bgc_cobalt.nc
  nmdz_obc_lfac_in = 0.03
  nmdz_obc_lfac_out = 1.0
  nlgz_obc_src_file_name = bgc_cobalt.nc
  nlgz_obc_lfac_in = 0.03
  nlgz_obc_lfac_out = 1.0
  nmdp_obc_src_file_name = bgc_cobalt.nc
  nmdp_obc_lfac_in = 0.03
  nmdp_obc_lfac_out = 1.0
  femdp_obc_src_file_name = bgc_cobalt.nc
  femdp_obc_lfac_in = 0.03
  femdp_obc_lfac_out = 1.0
  femd_obc_src_file_name = bgc_cobalt.nc
  femd_obc_lfac_in = 0.03
  femd_obc_lfac_out = 1.0
  simd_obc_src_file_name = bgc_cobalt.nc
  simd_obc_lfac_in = 0.03
  simd_obc_lfac_out = 1.0
  pdi_obc_src_file_name = bgc_cobalt.nc
  pdi_obc_lfac_in = 0.03
  pdi_obc_lfac_out = 1.0
  psm_obc_src_file_name = bgc_cobalt.nc
  psm_obc_lfac_in = 0.03
  psm_obc_lfac_out = 1.0
  pmd_obc_src_file_name = bgc_cobalt.nc
  pmd_obc_lfac_in = 0.03
  pmd_obc_lfac_out = 1.0
  nmd_obc_src_file_name = bgc_cobalt.nc
  nmd_obc_lfac_in = 0.03
  nmd_obc_lfac_out = 1.0
  plg_obc_src_file_name = bgc_cobalt.nc
  plg_obc_lfac_in = 0.03
  plg_obc_lfac_out = 1.0
/
      </fieldTable>
      <diagTable>
$name
$baseDate
      </diagTable>
      <dataFile label="diagTable" target="INPUT/" chksum="" size="" timestamp="">
	<dataSource site="ncrc">../NWA12/diag_tables/diag_table_CEFI_MOM6_default</dataSource>
	<dataSource site="ncrc">../NWA12/diag_tables/diag_table_CEFI_SIS_default</dataSource>
	<dataSource site="ncrc">../NWA12/diag_tables/diag_table_CEFI_COBALT_default</dataSource>
        <dataSource site="gfdl">/home/ynt/git/CEFI-regional-MOM6/xmls/NWA12/diag_tables/diag_table_CEFI_MOM6_default</dataSource>
        <dataSource site="gfdl">/home/ynt/git/CEFI-regional-MOM6/xmls/NWA12/diag_tables/diag_table_CEFI_SIS_default</dataSource>
        <dataSource site="gfdl">/home/ynt/git/CEFI-regional-MOM6/xmls/NWA12/diag_tables/diag_table_CEFI_COBALT_default</dataSource>
      </dataFile>
      <csh type='always'>
        <![CDATA[
truncate -s 0 $work/INPUT/MOM_override
cat > $work/INPUT/MOM_override << MOM_OVERRIDE_EOF
#override USE_generic_tracer = True
#override MAX_FIELDS=500
#override CHL_FROM_FILE = False
#override DO_GEOTHERMAL = True
#override DT = 400
# Update the nodal modulation of the tide every year
#override TIDE_NODAL_REF_DATE = ${fyear},7,2
#override MLE%USE_BODNER23 = True
#override MLE%CR = 0.03
#override MLE%BLD_DECAYING_TFILTER = 8.64E+04
#override MLE%MLD_DECAYING_TFILTER = 2.592E+06
#override MLE%MIN_WSTAR2 = 1.0E-09
#override MLE_USE_PBL_MLD = True
#override EPBL_ANSWER_DATE = 20231231
#override BBL_EFFIC = 0.0
#override LZ_RESCALE = 0.2
#override DIABATIC_FIRST = False
#override PHA_MLD_CALC = True
#override PHA_MLD_USE_DELTA_RHO = True
#override PHA_MLD_HREF = 10.0
#override PHA_MLD_DRHO = 0.03
#override HREF_FOR_MLD = 5.0
#override DIAG_MLD_DENSITY_DIFF = 0.03
#override VISC_REM_BUG = True
#override GENERIC_TRACER_IC_FILE = "NEP_COBALT_spinup_2003.nc"
#override U_TRUNC_FILE = "U.velocity_truncations"
#override V_TRUNC_FILE = "V.velocity_truncations"
MOM_OVERRIDE_EOF

truncate -s 0 $work/INPUT/COBALT_override
cat > $work/INPUT/COBALT_override << COBALT_OVERRIDE_EOF
! Put the contents of your COBALT_override file here.
! For parameters which are not specified in the COBALT_input file, just set the new value, ex:
! do_case2_mod = True
! For parameters which are specified in the COBALT_input file, specify an override, ex:
!#override do_case2_mod = True
!#override scale_burial = 1.0
COBALT_OVERRIDE_EOF

truncate -s 0 $work/INPUT/COBALT_input
cat > $work/INPUT/COBALT_input << COBALT_INPUT_EOF
! Put the contents of your COBALT_input file here
do_case2_mod = True
COBALT_INPUT_EOF

        ]]>
      </csh>
    </input>
    <runtime>
      <production simTime="$(PROD_SIMTIME)" units="years">
        <segment simTime="12" units="months"/>
        <resources jobWallclock="12:00:00" segRuntime="12:00:00">
          <ice                          layout = "32,80" io_layout = "1,1" mask_table="mask_table.524.32x80"/>
          <ocn ranks="2036" threads="1" layout = "32,80" io_layout = "1,1" mask_table="mask_table.524.32x80"/>
        </resources>
      </production>
      <regression name="month">
        <run months="1">
          <resources jobWallclock="04:00:00">
            <ice                          layout = "40,40" io_layout = "1,1" mask_table="MOM_mask_table"/>
            <ocn ranks="1600" threads="1" layout = "40,40" io_layout = "1,1" mask_table="MOM_mask_table"/>
          </resources>
        </run>
      </regression>
      <regression name="year">
        <run months="12">
          <resources jobWallclock="12:00:00">
            <ice                          layout = "32,80" io_layout = "1,1" mask_table="mask_table.524.32x80"/>
            <ocn ranks="2036" threads="1" layout = "32,80" io_layout = "1,1" mask_table="mask_table.524.32x80"/>
          </resources>
        </run>
      </regression>
      <regression name="test">
        <run days="2">
          <resources jobWallclock="01:00:00">
            <ice                          layout = "20,56" io_layout = "1,1" mask_table="mask_table.216.20x56"/>
            <ocn ranks="904" threads="1" layout = "20,56" io_layout = "1,1" mask_table="mask_table.216.20x56"/>
          </resources>
        </run>
      </regression>
      <regression name="layout">
        <run days="1">
          <resources jobWallclock="01:00:00">
            <ice                         layout = "40,40" io_layout = "1,1" mask_table="MOM_mask_table"/>
            <ocn ranks="1600" threads="1" layout = "40,40" io_layout = "1,1" mask_table="MOM_mask_table"/>
          </resources>
        </run>
        <run days="1">
          <resources jobWallclock="01:00:00">
            <ice                          layout = "30,30" io_layout = "1,1" mask_table="MOM_mask_table"/>
            <ocn ranks="900" threads="1" layout = "30,30" io_layout = "1,1" mask_table="MOM_mask_table"/>
          </resources>
        </run>
      </regression>
      <regression name="restart">
        <run days="1 1">
          <resources jobWallclock="01:00:00">
            <ice                         layout = "32,80" io_layout = "1,1" mask_table="mask_table.524.32x80"/>
            <ocn ranks="2036" threads="1" layout = "32,80" io_layout = "1,1" mask_table="mask_table.524.32x80"/>
          </resources>
        </run>
        <run days="2">
          <resources jobWallclock="01:00:00">
            <ice                         layout = "32,80" io_layout = "1,1" mask_table="mask_table.524.32x80"/>
            <ocn ranks="2036" threads="1" layout = "32,80" io_layout = "1,1" mask_table="mask_table.524.32x80"/>
          </resources>
        </run>
      </regression>
    </runtime>

    <postProcess>
      <csh><![CDATA[
         cd $work
         # Archive an assortment of model input files and model metadata
         mkdir metadata.out
         mv MOM_parameter_doc* SIS_parameter_doc* COBALT_parameter_doc* metadata.out/
         cp diag_table input.nml metadata.out/
         cp INPUT/*_input INPUT/*_override metadata.out/
         # Save the Git commit hash for each source code submodule
         git -C $root/$(LIBS_ROOT)/src/mom6 submodule status --recursive > metadata.out/git_submodule_status
         # Archive a copy of the xml used to run the model and the run script (fre sets these)
         cp $rtsxml metadata.out/
         cp $scriptName metadata.out/runscript.csh
         # When the ocean uses a mask_table the ocean_static.nc file produced by the model run has holes in coordinates (geolon,geolat)
         # This causes problems for ferret and python tools for analysis.
         # Copy a non-masked version of ocean_static.nc to be saved as a history file to be used by the analysis scripts.
         cp $work/INPUT/ocean_static_no_mask_table.nc $work/ocean_static.nc
      ]]></csh>
      <xi:include xpointer="xpointer(//freInclude[@name='MOM6_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='COBALT_postprocess']/postProcess/node())"/>
      <xi:include xpointer="xpointer(//freInclude[@name='COBALT_z_postprocess']/postProcess/node())"/>
    </postProcess>

  </experiment>


  <!-- For a new run starting from non-restart initial conditions, this starts the first year as a new run and then restarts for subsequent years -->
  <freInclude name="choose_restart">
    <input>
      <csh type="always">
        <![CDATA[
#------------------------------------------
## Find out whether to restart.

if ( $currentSeg == 1 ) then
    set restart_flag = 'n'
    if(-e $work/INPUT/coupler.res ) then
        rm -rf $work/INPUT/coupler.res
        rm -rf $work/INPUT/ice_cobalt.res.nc
        rm -rf $work/INPUT/ice_model.res.nc
        rm -rf $work/INPUT/MOM.res*.nc
        rm -rf $work/INPUT/ocean_cobalt_airsea_flux.res.nc
    endif
else
    set restart_flag = 'r'
    #Because of a technical issue FRE does not delete old uncombined restarts before copying the new ones for the next segment
    #The INPUT/ ends up with inconsistent restart files which at best cause the model to crash right away.
    if(-e $work/INPUT/MOM.res.nc.0000 ) \rm -rf $work/INPUT/MOM.res*.nc
endif
        ]]>
      </csh>
    </input>
  </freInclude>

  <!-- For a new run starting from a restart file (e.g. from the end of a spinup simulation), this always sets the restart flag -->
  <freInclude name="always_restart">
    <input>
      <csh type="always">
        <![CDATA[
set restart_flag = 'r'
#Because of a technical issue FRE does not delete old uncombined restarts before copying the new ones for the next segment
#The INPUT/ ends up with inconsistent restart files which at best cause the model to crash right away.
if(-e $work/INPUT/MOM.res.nc.0000 ) \rm -rf $work/INPUT/MOM.res*.nc
        ]]>
      </csh>
    </input>
  </freInclude>

  <freInclude name="OM4_common">
    <input>
      <csh type="always">
        <![CDATA[
ln -s $work/INPUT/ocean_topog.nc $work/INPUT/topog.nc

touch $work/INPUT/MOM_override
touch $work/INPUT/SIS_override
touch $work/INPUT/MOM_layout
touch $work/INPUT/SIS_layout

# Record the job stdout location for later use timings database
cat >> $HOME/frejobs_stdout <<EOF_frejobs
$stdoutDir/$FRE_JOBID
EOF_frejobs

cat > $work/INPUT/MOM_layout << MOM_LAYOUT_EOF
#override IO_LAYOUT = $ocn_io_layout
#override LAYOUT    = $ocn_layout
#override MASKTABLE = $ocn_mask_table
#override OCEAN_OMP_THREADS = $ocn_threads
MOM_LAYOUT_EOF

cat > $work/INPUT/SIS_layout << SIS_LAYOUT_EOF
#override IO_LAYOUT = $ice_io_layout
#override LAYOUT    = $ice_layout
#override MASKTABLE = $ice_mask_table
SIS_LAYOUT_EOF

cat > $work/INPUT/SIS_override << SIS_OVERRIDE_EOF
#override ICE_STATS_INTERVAL = 10.
#override DO_ICEBERGS = False
#override ICE_OCEAN_STRESS_STAGGER = "C"
SIS_OVERRIDE_EOF

cat > $work/INPUT/SIS_diurnal << SIS_diurnal_EOF
SIS_diurnal_EOF

# add empty MOM_mask_table
if ( ! -e $work/INPUT/MOM_mask_table ) then
    echo "0" > $work/INPUT/MOM_mask_table
endif

cd $work/INPUT
ln -sf nep_10km_glorys_obcs_${fyear}.nc obcs.nc
ln -sf glorys_monthly_NEP_sponge_${fyear}_clim.nc  nep_10k_glorys_mnClim.nc

if ( $(target) == 'debug' ) then
echo "we are testing in debug mode. Need to re-create grid masks!"
cd $work/INPUT
rm -rf $work/INPUT/ocean_mask.nc
rm -rf $work/INPUT/ocean_mosaic.nc
rm -rf $work/INPUT/atmos_mosaic_tile1X*
rm -rf $work/INPUT/grid_spec.nc
rm -rf $work/INPUT/land_m*
make_solo_mosaic --num_tiles 1 --dir . --mosaic_name ocean_mosaic --tile_file ocean_hgrid.nc
make_quick_mosaic --input_mosaic ocean_mosaic.nc --mosaic_name grid_spec --ocean_topog ocean_topog.nc
ln -fs $work/INPUT/ocean_topog.nc $work/INPUT/topog.nc
endif

      ]]>
      </csh>
    </input>
  </freInclude>

  <freInclude name="nep_grid">
    <input>
      <dataFile label="gridSpec" target="INPUT/" chksum="" size="" timestamp="">
	<dataSource site="ncrc">$(NEP_WORLD)/grid/nep_grid_75z.tar</dataSource>
        <dataSource site="gfdl">/work/Liz.Drenkard/mom6/nep_10km/setup/grid/nep_grid_75z.tar</dataSource>
      </dataFile>
      <!-- Vertical coordinates to regrid 3D diagnostics to -->
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
	<dataSource site="ncrc">$(NEP_WORLD)/diags/diag_dz.nc</dataSource>
      </dataFile>
    </input>
  </freInclude>

  <freInclude name="nep_data">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <!-- Main settings -->
        <dataSource site="ncrc">$(NEP_WORLD)/mask_tables/mask_table.216.20x56</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/mask_tables/mask_table.524.32x80</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/MOM_input</dataSource>
        <!-- Initial conditions -->
        <dataSource site="ncrc">$(NEP_WORLD)/inits/glorys/nep_10km_init_1993-01-01_glorys.nc</dataSource>
	<dataSource site="ncrc">$(NEP_WORLD)/inits/bgc/bgc_ics_75z.nc</dataSource>
	<dataSource site="ncrc">$(NEP_WORLD)/spinup/NEP_COBALT_spinup_2003.nc</dataSource>
        <!-- Boundary conditions for BGC -->
        <dataSource site="ncrc">$(NEP_WORLD)/obcs/bgc/bgc_esper.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/obcs/bgc/bgc_woa.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/obcs/bgc/bgc_cobalt.nc</dataSource>
        <!-- Boundary conditions for physics -->
        <dataSource site="ncrc">$(NEP_WORLD)/obcs/glorys/nep_10km_glorys_obcs_${fyear}.nc</dataSource>
        <!-- Files for tidal boundary conditions -->
        <dataSource site="ncrc">$(NEP_WORLD)/tides/tu_001.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/tides/tu_002.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/tides/tu_003.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/tides/tu_004.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/tides/tz_001.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/tides/tz_002.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/tides/tz_003.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/tides/tz_004.nc</dataSource>
        <!-- Files for physical sponges -->
        <dataSource site="ncrc">$(NEP_WORLD)/sponge/nep_10km_damp_2dy_20gc.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/sponge/clims/glorys_monthly_NEP_sponge_${fyear}_clim.nc</dataSource>
        <!-- Atmos forcing-->
        <!-- Note that putting ${fyear} causes warnings about the files not being found,
             but it will still run correctly. These files used to be symlinked before f2 problems. -->
        <dataSource site="ncrc">$(NEP_WORLD)/../NEP_era5/ERA5_msl_${fyear}_padded.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/../NEP_era5/ERA5_t2m_${fyear}_padded.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/../NEP_era5/ERA5_sphum_${fyear}_padded.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/../NEP_era5/ERA5_strd_${fyear}_padded.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/../NEP_era5/ERA5_ssrd_${fyear}_padded.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/../NEP_era5/ERA5_lp_${fyear}_padded.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/../NEP_era5/ERA5_sf_${fyear}_padded.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/../NEP_era5/ERA5_u10_${fyear}_padded.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/../NEP_era5/ERA5_v10_${fyear}_padded.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/runoff/glofas_v4/glofas_v4_hill_dis_runoff_${fyear}.nc</dataSource>
      <!-- Extra file for chlorophyll for estimating opacity: -->
        <dataSource site="ncrc">$(NEP_WORLD)/opacity/seawifs-clim-1997-2010.nep.nc</dataSource>
      <!-- Files for BGC fluxes from atmosphere -->
        <dataSource site="ncrc">$(GLOBAL_WORLD)/esm4_deposition/esm4_drydust_climo_1993-2014.nc</dataSource>
        <dataSource site="ncrc">$(GLOBAL_WORLD)/esm4_deposition/esm4_wetdust_climo_1993-2014.nc</dataSource>
        <dataSource site="ncrc">$(GLOBAL_WORLD)/esm4_deposition/esm4_dryfe_climo_1993-2014.nc</dataSource>
        <dataSource site="ncrc">$(GLOBAL_WORLD)/esm4_deposition/esm4_wetfe_climo_1993-2014.nc</dataSource>
        <dataSource site="ncrc">$(GLOBAL_WORLD)/esm4_deposition/esm4_drynh4_climo_1993-2014.nc</dataSource>
        <dataSource site="ncrc">$(GLOBAL_WORLD)/esm4_deposition/esm4_wetnh4_climo_1993-2014.nc</dataSource>
        <dataSource site="ncrc">$(GLOBAL_WORLD)/esm4_deposition/esm4_drynh3_climo_1993-2014.nc</dataSource>
        <dataSource site="ncrc">$(GLOBAL_WORLD)/esm4_deposition/esm4_wetnh3_climo_1993-2014.nc</dataSource>
        <dataSource site="ncrc">$(GLOBAL_WORLD)/esm4_deposition/esm4_wetnoy_climo_1993-2014.nc</dataSource>
        <dataSource site="ncrc">$(GLOBAL_WORLD)/esm4_deposition/esm4_drynoy_climo_1993-2014.nc</dataSource>
	<dataSource site="ncrc">$(GLOBAL_WORLD)/co2/mole_fraction_of_co2_extended_ssp245.nc</dataSource>
        <dataSource site="ncrc">$(NEP_WORLD)/runoff/RiverNutrients_Combined_Q100_NEP10k_plusSi.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(NEP_WORLD)/global_input/depflux_total.mean.1860.nc</dataSource>
      </dataFile>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(NEP_WORLD)/global_input/Mineral_Flux_AM4.nc</dataSource>
      </dataFile>
      <namelist name="MOM_input_nml">
         output_directory = './'
         input_filename = '$restart_flag'
         restart_input_dir = 'INPUT/'
         restart_output_dir = 'RESTART/'
         parameter_filename = 'INPUT/MOM_input','INPUT/MOM_layout','INPUT/MOM_override'
      </namelist>
    </input>
  </freInclude>

  <freInclude name="SIS2_data">
    <input>
      <dataFile label="input" target="INPUT/" chksum="" size="" timestamp="">
        <dataSource site="ncrc">$(NEP_WORLD)/SIS_input</dataSource>
      </dataFile>
      <namelist name="SIS_input_nml">
        output_directory = './'
        input_filename = '$restart_flag'
        restart_input_dir = 'INPUT/'
        restart_output_dir = 'RESTART/'
        parameter_filename = 'INPUT/SIS_input','INPUT/SIS_layout','INPUT/SIS_override'
      </namelist>
    </input>
  </freInclude>
  <freInclude name="COBALT_postprocess">
    <postProcess>
      <component type="ocean_cobalt_fdet_100" start="$(PP_START_YEAR)" source="ocean_cobalt_fdet_100">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_cobalt_btm" start="$(PP_START_YEAR)" source="ocean_cobalt_btm">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_cobalt_daily_2d" start="$(PP_START_YEAR)" source="ocean_cobalt_daily_2d">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)" />
      </component>
      <component type="ocean_cobalt_omip_sfc" start="$(PP_START_YEAR)" source="ocean_cobalt_omip_sfc">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_cobalt_tracers_int" start="$(PP_START_YEAR)" source="ocean_cobalt_tracers_int">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_cobalt_sfc" start="$(PP_START_YEAR)" source="ocean_cobalt_sfc">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_cobalt_fluxes_int" start="$(PP_START_YEAR)" source="ocean_cobalt_fluxes_int">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_cobalt_omip_2d" start="$(PP_START_YEAR)" source="ocean_cobalt_omip_2d">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
    </postProcess>
  </freInclude>
  <freInclude name="COBALT_z_postprocess">
    <postProcess>
      <component type="ocean_cobalt_tracers_month_z" start="$(PP_START_YEAR)" source="ocean_cobalt_tracers_month_z">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_A)" />
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeSeries freq="annual" chunkLength="$(CHUNK_LENGTH_B)" />
        <timeAverage source="monthly"  interval="$(CHUNK_LENGTH_B)"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>
    </postProcess>
  </freInclude>
  <freInclude name="MOM6_postprocess">
    <postProcess>
      <!--PostProcessing component models-->
      <component type="ocean_daily"   start="$(PP_START_YEAR)" source="ocean_daily">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_daily"/>
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_daily">
          <variables>
            tos tob ssh sshmin sshmax
          </variables>
        </timeSeries>
      </component>
      <component type="ocean_monthly" start="$(PP_START_YEAR)"  source="ocean_month">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_monthly_z" start="$(PP_START_YEAR)"  source="ocean_month_z">
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)" source="ocean_month_z"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)" source="ocean_month_z"/>
        <timeAverage source="monthly" interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_annual"  start="$(PP_START_YEAR)" source="ocean_annual">
        <timeSeries freq="annual"   chunkLength="$(CHUNK_LENGTH_A)" source="ocean_annual"/>
        <timeSeries freq="annual"   chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
      </component>
      <component type="ocean_annual_z" start="$(PP_START_YEAR)" source="ocean_annual_z" >
        <timeSeries freq="annual"  chunkLength="$(CHUNK_LENGTH_A)" source="ocean_annual_z"/>
        <timeAverage source="annual" interval="$(CHUNK_LENGTH_B)"/>
        <timeSeries freq="annual"  chunkLength="$(CHUNK_LENGTH_B)" source="ocean_annual_z"/>
      </component>

      <!--ICE-->
      <component type="ice_daily"   start="$(PP_START_YEAR)" source="ice_daily">
        <timeSeries freq="daily" chunkLength="$(CHUNK_LENGTH_A)" source="ice_daily"/>
      </component>
      <component type="ice_monthly"  start="$(PP_START_YEAR)"  source="ice_month" >
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_A)"  source="ice_month"/>
        <timeSeries freq="monthly" chunkLength="$(CHUNK_LENGTH_B)"  source="ice_month"/>
        <timeAverage source="annual"  interval="$(CHUNK_LENGTH_B)"/>
      </component>

    </postProcess>
  </freInclude>

</experimentSuite>

